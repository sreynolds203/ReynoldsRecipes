{% extends "base.html" %}
{% block content %}
<div style="max-width:900px;margin:24px auto">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h1>Recipes</h1>
    <div>
      <a href="{% url 'recipes:create' %}">+ New Recipe</a>
    </div>
  </div>

  <form method="post" action="{% url 'recipes:shopping_list' %}">
    {% csrf_token %}
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
      <div></div>
      <button type="submit">Create Shopping List from Selected</button>
    </div>

    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;margin-top:12px">
    {% for r in recipes %}
      <div style="background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.06);position:relative;overflow:hidden">
        <div style="position:absolute;top:8px;right:8px;background:rgba(255,255,255,0.9);padding:4px 6px;border-radius:6px;z-index:2">
          <label style="font-size:.9rem;display:flex;align-items:center;gap:6px"><input type="checkbox" name="selected" value="{{ r.pk }}"> Select</label>
        </div>
        {% if r.image %}
          <img src="{{ r.image.url }}" alt="" style="width:100%;height:140px;object-fit:cover;border-radius:6px;margin-bottom:8px"/>
        {% endif %}
        <div style="font-weight:600">{{ r.title }}</div>
        <div style="font-size:.9rem;color:#555">{{ r.description|truncatechars:80 }}</div>
        <div style="margin-top:8px">
          <a href="{% url 'recipes:detail' r.pk %}">View</a> ·
          <a href="{% url 'recipes:update' r.pk %}">Edit</a>
        </div>
      </div>
    {% empty %}
      <p>No recipes yet. <a href="{% url 'recipes:create' %}">Add one</a>.</p>
    {% endfor %}
    </div>
  </form>

  {% if is_paginated %}
    <div style="margin-top:16px">
      {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">‹ prev</a>{% endif %}
      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
      {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">next ›</a>{% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}
